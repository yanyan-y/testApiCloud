webpackJsonp([37],{sO8D:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("mvHQ"),a=n.n(i),s=n("Gu7T"),o=n.n(s),r=n("D8a4"),l=n("FHgB"),c=n.n(l),u=n("7Ah8"),d=n("S8Wg"),h=n("fBcm"),p=n("cHu4"),f=n("ABCa"),g=n("odqc"),v=n("Znkm"),m=n("b+jt"),x=n("eHAg"),b=n("SROd"),w={content:"下拉刷新",height:40,autoRefresh:!1,downContent:"下拉刷新",upContent:"释放后刷新",loadingContent:"",clsPrefix:"xs-plugin-pulldown-"},C={content:"",pullUpHeight:60,height:40,autoRefresh:!1,downContent:"释放后加载",upContent:"",loadingContent:"加载中...",clsPrefix:"xs-plugin-pullup-"},S=(d.a,f.a,u.a,r.a,h.a,p.a,c.a,g.a,v.a,m.a,x.default,b.default,{content:"下拉刷新",height:40,autoRefresh:!1,downContent:"下拉刷新",upContent:"释放后刷新",loadingContent:"",clsPrefix:"xs-plugin-pulldown-"}),I={content:"",pullUpHeight:60,height:40,autoRefresh:!1,downContent:"释放后加载",upContent:"",loadingContent:"加载中...",clsPrefix:"xs-plugin-pullup-"},y={name:"news",components:{Scroller:d.a,XHeader:f.a,PopupPicker:u.a,Badge:r.a,Swiper:h.a,XAddress:p.a,ChinaAddressV4Data:c.a,Tab:g.a,TabItem:v.a,SwiperItem:m.a,News_Info:x.default,Video_Info:b.default},data:function(){return{pulldownDefaultConfig:S,pullupDefaultConfig:I,barList:[{pageName:"首页",name:"news_Info",lable:"Hi，头条",id:0,dataList:[],status:!1},{pageName:"首页",name:"Video_Info",lable:"视频",id:1,dataList:[],status:!1}],indexSs:0,demo3:0,xheight:"",currentpage:1,lastPage:1,city:"",province:"",curreIndex:0,newsInfoTop:0}},created:function(){this.xheight=window.screen.availHeight-143+"px"},mounted:function(){this.info()},methods:{xheightS1:function(){return window.screen.availHeight-47+"px"},info:function(){if(localStorage.getItem("city")&&JSON.parse(localStorage.getItem("city")).province){var t=JSON.parse(localStorage.getItem("city"));this.province=t.province,this.city=t.city,this.getInfoAll(this.indexSs)}else this.getPosition()},changeSwiper:function(t){this.curreIndex=t,this.getInfoAll(t)},getInfoAll:function(t){var e=this;if(console.log(this.barList[t].status),!this.barList[t].status){this.currentPage=1;var n={page:this.currentPage,region:""};if(this.province)n.region=this.province;else{["北京市","天津市","重庆市","上海市"].forEach(function(t){t==e.city&&(n.region=t)})}this.$vux.loading.show({text:"加载中..."}),this.$http.get({api:0===t?"news":"video",params:n}).then(function(n){if(e.$vux.loading.hide(),!n.status)return e.$vux.toast.show({type:"text",text:n.messages,position:"bottom",width:"15em"});e.$nextTick(function(){this.barList.forEach(function(e,i){t===i&&(e.dataList=n.data,e.status=!0)})})},function(t){e.$vux.loading.hide(),e.$vux.toast.show({type:"text",text:t.messages,position:"bottom",width:"15em"})})}},changeChild:function(t){this.$nextTick(function(){this.barList[this.curreIndex].dataList=[].concat(o()(this.barList[this.curreIndex].dataList),o()(t))})},getPosition:function(){var t=this;navigator.geolocation.getCurrentPosition(t.onSuccess,t.onError,{enableHighAccuracy:!0,coorType:"bd09ll"})},onSuccess:function(t){var e=this,n=new BMap.Point(t.coords.longitude,t.coords.latitude);if(t){var i=new BMap.Convertor,a=[];a.push(n),i.translate(a,1,5,e.translateCallback)}},onError:function(t){},translateCallback:function(t){var e=this;if(0===t.status){var n={lng:t.points[0].lng,lat:t.points[0].lat},i=new BMap.Geocoder,s=new BMap.Point(n.lng,n.lat);i.getLocation(s,function(t){e.city=t.addressComponents.city,e.province=t.addressComponents.province;var n={province:e.province,city:e.city};if(e.city||e.province){var i=[];i.unshift(e.city),localStorage.setItem("recentsCity",a()(i)),localStorage.setItem("city",a()(n)),e.getInfoAll(e.indexSs)}else e.getInfoAll(e.indexSs)})}},reset:function(t){var e=this;this.$nextTick(function(){e.$refs.scrollerT.reset()})}},activated:function(){this.$route.meta.isUseCache||this.getInfoAll(this.indexSs)},beforeRouteEnter:function(t,e,n){n(function(t){document.body.scrollTop=t.scrollTop})},beforeRouteLeave:function(t,e,n){"newsDetails"===t.name||"advertising"===t.name||"videoDetails"===t.name?(e.meta.isUseCache=!0,e.meta.keepAlive=!0):(e.meta.isUseCache=!1,e.meta.keepAlive=!1),this.$store.commit("setNewsTopValue",this.$refs.News_Info.mescroll.getScrollTop()),this.$store.commit("setVideoTopValue",this.$refs.Video_Info.mescroll.getScrollTop()),n()}},L=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"news",style:{height:t.xheightS1()}},[n("yd-navbar",{staticStyle:{"background-color":"#2389E3"},attrs:{slot:"navbar"},slot:"navbar"},[n("router-link",{attrs:{slot:"center",to:""},slot:"center"},[t._v("发现")])],1),t._v(" "),t._t("top",[n("tab",{attrs:{"custom-bar-width":"22px","default-color":"#849098","active-color":"#2389E3","bar-active-color":"#2389E3","line-width":3},model:{value:t.indexSs,callback:function(e){t.indexSs=e},expression:"indexSs"}},t._l(t.barList,function(e){return n("tab-item",{key:e.lable,staticClass:"vux-center",staticStyle:{"font-size":"15px"},attrs:{selected:t.demo3===e.lable}},[t._v(t._s(e.lable))])}),1)]),t._v(" "),n("swiper",{attrs:{height:t.xheight,"show-dots":!1,threshold:150},on:{"on-index-change":t.changeSwiper},model:{value:t.indexSs,callback:function(e){t.indexSs=e},expression:"indexSs"}},[n("swiper-item",[n("div",{staticClass:"tab-swiper vux-center swiper-box"},[n("News_Info",{ref:"News_Info",attrs:{list:t.barList[0].dataList,status:t.barList[0].status,pageName:t.barList[0].pageName},on:{changeChild:t.changeChild}})],1)]),t._v(" "),n("swiper-item",[n("div",{staticClass:"tab-swiper vux-center swiper-box"},[n("Video_Info",{ref:"Video_Info",attrs:{list:t.barList[1].dataList,status:t.barList[1].status,pageName:t.barList[0].pageName},on:{changeChild:t.changeChild}})],1)])],1)],2)},_=[],$={render:L,staticRenderFns:_},k=$,P=n("VU/8"),T=P(y,k,!1,null,null,null);e.default=T.exports}});